## 什么是Dubbo

Dubbo是分布式服务框架，致力于提供高性能和透明化的RPC远程服务调用方案，以及SOA服务治理方案

## Dubbo角色

* 服务容器
* 提供者
* 注册中心
* 消费者
* 监听器

## 各自角色流程

![](/assets/architecture.png)

## 调用关系说明

* 0.服务容器负责启动，加载，运行服务提供者。
* 1.服务提供者在启动时，向注册中心注册自己提供的服务。
* 2.服务消费者在启动时，向注册中心订阅自己所需的服务。
* 3.注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。
* 4.服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。
* 5.服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心

## 注意点

* 注册中心，服务提供者，服务消费者三者之间均为长连接，监控中心除外
* 注册中心通过长连接感知服务提供者的存在，服务提供者宕机，注册中心将立即推送事件通知消费者
* 注册中心和监控中心全部宕机，不影响已运行的提供者和消费者，消费者在本地缓存了提供者列表
* 注册中心和监控中心都是可选的，服务消费者可以直连服务提供者

## Dubbo方面

* 服务管理
* 通信细节
* 序列化

## dubbo都支持什么协议，推荐用哪种？

dubbo://（推荐）  
rmi://  
hessian://  
http://  
webservice://  
thrift://  
memcached://  
redis://  
rest://

## 在 Provider 上可以配置的 Consumer 端的属性有哪些？

1）timeout：方法调用超时  
2）retries：失败重试次数，默认重试 2 次  
3）loadbalance：负载均衡算法，默认随机  
4）actives 消费者端，最大并发调用限制

## Dubbo有哪几种集群容错方案，默认是哪种？

集群容错方案    说明  
Failover Cluster    失败自动切换，自动重试其它服务器（默认）  
Failfast Cluster    快速失败，立即报错，只发起一次调用  
Failsafe Cluster    失败安全，出现异常时，直接忽略  
Failback Cluster    失败自动恢复，记录失败请求，定时重发  
Forking Cluster     并行调用多个服务器，只要一个成功即返回  
Broadcast Cluster    广播逐个调用所有提供者，任意一个报错则报错


## Dubbo有哪几种负载均衡策略，默认是哪种？

负载均衡策略    说明  
Random LoadBalance    随机，按权重设置随机概率（默认）  
RoundRobin LoadBalance    轮询，按公约后的权重设置轮询比率  
LeastActive LoadBalance    最少活跃调用数，相同活跃数的随机  
ConsistentHash LoadBalance    一致性 Hash，相同参数的请求总是发到同一提供者

