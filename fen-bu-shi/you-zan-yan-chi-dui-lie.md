https://tech.youzan.com/queuing_delay/


创建订单的时候就插入延迟队列，设置 30 分钟延迟
worker 长轮训这个队列，30 分钟自动可见，消费的时候开启事务锁订单，检查是否已支付，如果未支付就关单退优惠券，已支付的话就删除消息